<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="../css/teacher.css" />
		<script type="text/javascript" src="../js/zc_utils.js"></script>
		<style type="text/css">
			html,body{
				height: 100%;
				width: 100%;
				background-color: #fff;
			}
			.mui-table-view.mui-grid-view .mui-table-view-cell{
				margin-right: 0;
			}
			.mui-table-view li{
				padding-top: 16px!important;
				padding-bottom: 2px!important;
			}
			.mui-table-view:after{
				content: "";
				height: 0;
			}
			.num_money:after{
			    content: "";
			    width: 0;
			    height: 0;
			    border-left: 10px dashed transparent;
			    border-right: 10px dashed transparent;
			    border-bottom: 16px dashed #F2F2F2;
			    position: absolute;
			    top: -14px;
			    right: 14%;
			    z-index: 1;
			}
			.interval{
				width: 100%;
			    height: 6px;
			    background-color: #f1f1f1;
			}
			.mui-table-view:before{
				content: "";
				height: 0;
			}
		</style>
	</head>
	<body>
		<header class="mui-bar mui-bar-nav" style="height: 55px;">
		    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"style="margin-top: 15px;padding-right: 30px;"></a>
		    <h1 class="mui-title"style="margin-top: 15px;font-weight: 300;">赞赏讲师</h1>
		</header>
		<div class="mui-content" style="padding-top:56px;">
			<div style="background-color: #FFFFFF;">
				<div style="margin-left: 12px;color: #323232;padding-top: 10px;font-size: 14px;">《生鲜课程培训第一章》</div>
				<div style="margin-left: 17px;color: #4c4c4c;margin-top: 10px;padding-bottom: 10px;font-size: 13px;">当前讲师：李晓松</div>
			</div>
		</div>
		<div class="interval"></div>
		<div>
		    <ul class="mui-table-view mui-grid-view" style="padding: 0;line-height: 0;">
		        <li class="mui-table-view-cell mui-media mui-col-xs-4" >
		            <a id="mui-retail1" onclick="">
		                <img class="mui-media-object" src="../img/tea/icon_1.png" id="bq1" style="width:60px;height: 60px;margin-left: -25px;" >
		                <div class="mui-media-body " id="mui-view-fonts" style="margin-left: -12px;color: #515151;font-size: 13px;">冰淇淋￥3</div></a></li>
		         <li class="mui-table-view-cell mui-media mui-col-xs-4" >
		            <a id="mui-retail2" onclick="">
		                <img class="mui-media-object" src="../img/tea/icon_2.png"id="bq2" style="width:60px;height: 60px;margin-left: -25px;" >
		                <div class="mui-media-body " id="mui-view-fonts" style="margin-left: -12px;color: #515151;font-size: 13px;">鲜果￥7</div></a></li>
		    	 <li class="mui-table-view-cell mui-media mui-col-xs-4" >
		            <a id="mui-retail3" onclick="">
		                <img class="mui-media-object" src="../img/tea/icon_3.png"id="bq3" style="width:60px;height: 60px;margin-left: -25px;" >
		                <div class="mui-media-body " id="mui-view-fonts" style="margin-left: -12px;color: #515151;font-size: 13px;">汉堡包￥10</div></a></li>
		    	 <li class="mui-table-view-cell mui-media mui-col-xs-4" >
		            <a id="mui-retail4" onclick="">
		                <img class="mui-media-object" src="../img/tea/icon_4.png"id="bq4" style="width:60px;height: 60px;margin-left: -25px;" >
		                <div class="mui-media-body " id="mui-view-fonts" style="margin-left: -12px;color: #515151;font-size: 13px;">咖啡￥15</div></a></li>
		         <li class="mui-table-view-cell mui-media mui-col-xs-4" >
		            <a id="mui-retail5" onclick="">
		                <img class="mui-media-object" src="../img/tea/icon_5.png" id="bq5" style="width:60px;height: 60px;margin-left: -25px;" >
		                <div class="mui-media-body " id="mui-view-fonts" style="margin-left: -12px;color: #515151;font-size: 13px;">红酒￥20</div></a></li>
		    	 <li class="mui-table-view-cell mui-media mui-col-xs-4" >
		            <a id="mui-retail6" onclick="">
		                <img class="mui-media-object" src="../img/tea/icon_6s.png"id="bq6" style="width:60px;height: 60px;margin-left: -25px;" >
		                <div class="mui-media-body " id="mui-view-fonts" style="margin-left: -12px;color: #515151;font-size: 13px;">神秘礼物</div></a></li>
		       <div class="num_money"style="margin-top: 25px;position: relative;">
		       		<input type="text" style="width:90%;margin-left: 5%;background: #F2F2F2;border: 1px dashed #C0C0C0;font-size: 14px;" placeholder="土豪请随意" />
		       	</div>   
		       <div style="width: 100%;margin-top: 20px;">
					<button type="button" class="mui-btn mui-btn-primary" style="width:90%;padding-top: 10px;padding-bottom: 10px;background-color: #69A6DD;margin-left: 5%;border: none;" onclick="pay('wxpay')">确认打赏</button>
		       </div>
		      
		    </ul> 
		</div>
		<script src="../js/mui.min.js"></script>
		<script type="text/javascript" src="../js/jquery.min.js"></script>
		<script type="text/javascript" src="../js/h.js" ></script>
		<script type="text/javascript" src="../js/md5.js" ></script>
		<script type="text/javascript">
			mui.init();
			h("#mui-retail1").tap(function(){changeBarIcon(1);$(".num_money").css("display","none")});
      		h("#mui-retail2").tap(function(){changeBarIcon(2);$(".num_money").css("display","none")});
      		h("#mui-retail3").tap(function(){changeBarIcon(3);$(".num_money").css("display","none")});
      		h("#mui-retail4").tap(function(){changeBarIcon(4);$(".num_money").css("display","none")});
      		h("#mui-retail5").tap(function(){changeBarIcon(5);$(".num_money").css("display","none")});
      		h("#mui-retail6").tap(function(){changeBarIcon(6);$(".num_money").css("display","block")});

			function changeBarIcon(index) {
				switch(index) {
					case 1:
						h("#bq1").attr('src', '../img/tea/icon_1s.png');
						h("#bq2").attr('src', '../img/tea/icon_2.png');
						h("#bq3").attr('src', '../img/tea/icon_3.png');
						h("#bq4").attr('src', '../img/tea/icon_4.png');
						h("#bq5").attr('src', '../img/tea/icon_5.png');
						h("#bq6").attr('src', '../img/tea/icon_6.png');
						break;
					case 2:
						h("#bq1").attr('src', '../img/tea/icon_1.png');
						h("#bq2").attr('src', '../img/tea/icon_2s.png');
						h("#bq3").attr('src', '../img/tea/icon_3.png');
						h("#bq4").attr('src', '../img/tea/icon_4.png');
						h("#bq5").attr('src', '../img/tea/icon_5.png');
						h("#bq6").attr('src', '../img/tea/icon_6.png');
						break;
		
					case 3:
						h("#bq1").attr('src', '../img/tea/icon_1.png');
						h("#bq2").attr('src', '../img/tea/icon_2.png');
						h("#bq3").attr('src', '../img/tea/icon_3s.png');
						h("#bq4").attr('src', '../img/tea/icon_4.png');
						h("#bq5").attr('src', '../img/tea/icon_5.png');
						h("#bq6").attr('src', '../img/tea/icon_6.png');
						break;
					case 4:
						h("#bq1").attr('src', '../img/tea/icon_1.png');
						h("#bq2").attr('src', '../img/tea/icon_2.png');
						h("#bq3").attr('src', '../img/tea/icon_3.png');
						h("#bq4").attr('src', '../img/tea/icon_4s.png');
						h("#bq5").attr('src', '../img/tea/icon_5.png');
						h("#bq6").attr('src', '../img/tea/icon_6.png');
						break;
					case 5:
						h("#bq1").attr('src', '../img/tea/icon_1.png');
						h("#bq2").attr('src', '../img/tea/icon_2.png');
						h("#bq3").attr('src', '../img/tea/icon_3.png');
						h("#bq4").attr('src', '../img/tea/icon_4.png');
						h("#bq5").attr('src', '../img/tea/icon_5s.png');
						h("#bq6").attr('src', '../img/tea/icon_6.png');
						break;
					case 6:
						h("#bq1").attr('src', '../img/tea/icon_1.png');
						h("#bq2").attr('src', '../img/tea/icon_2.png');
						h("#bq3").attr('src', '../img/tea/icon_3.png');
						h("#bq4").attr('src', '../img/tea/icon_4.png');
						h("#bq5").attr('src', '../img/tea/icon_5.png');
						h("#bq6").attr('src', '../img/tea/icon_6s.png');
						break;
					default:
						break;
				}
			}
			
			var channel=null;
			// 1. 获取支付通道
			mui.plusReady(function() {
			    // 获取支付通道
			    plus.payment.getChannels(function(channels){
			    	ShowTheObject(channels[1]);
			        channel=channels[1];
			    },function(e){
			        alert("获取支付通道失败："+e.message);
			    });
			});
			
			function ShowTheObject(obj){  
		  		var des = "";  
			    for(var name in obj){  
			    	des += name + ":" + obj[name] + ";";  
		     	}  
			  	console.log(des);  
			}  

			
			var ALIPAYSERVER= serverAddress + "wxpay.do?method=getLiveChat"; 
			var WXPAYSERVER= serverAddress + "wxpay.do?method=getLiveChat"; 
	        // 2. 发起支付请求 
	        function pay(id){ 
	        	var appid = plus.runtime.appid;
                // 从服务器请求支付订单 
                var PAYSERVER=''; 
                if(id=='alipay'){ 
	                PAYSERVER=ALIPAYSERVER; 
	            }else if(id=='wxpay'){ 
                    PAYSERVER=WXPAYSERVER; 
                }else{ 
                    plus.nativeUI.alert("不支持此支付通道！",null,"捐赠"); 
                    return; 
             	} 
                var xhr=new XMLHttpRequest(); 
                xhr.onreadystatechange=function(){ 
                    switch(xhr.readyState){ 
                        case 4: 
	                        if(xhr.status==200){ 
	                        	console.log(channel);
	                        	ShowTheObject(channel);
	                            plus.payment.request(channel,xhr.responseText,function(result){ 
	                                plus.nativeUI.alert("支付成功！",function(){ 
	                                back(); 
	                            }); 
	                            },function(error){ 
	                                plus.nativeUI.alert("支付失败：" + error.code); 
	                            }); 
	                        }else{ 
	                            alert("获取订单信息失败！"); 
	                        } 
                        break; 
                    	default: 
                    	break; 
                	} 
	         	} 
	         	var orderId = "RW-" + getTimestamp();
	         	orderId = md5(orderId);
	         	console.log(PAYSERVER + '&total_fee=1&orderId=' + orderId);
	            xhr.open('GET',PAYSERVER + '&total_fee=1&orderId=' + orderId); 
	            xhr.send(); 
	    	} 
		</script>
	</body>

</html>